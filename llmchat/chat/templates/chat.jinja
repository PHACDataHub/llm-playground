{% extends 'base.jinja' %}
{% block content %}
  <div class="container">
    <h1>Chat with PaLM 2 Large Language Model (LLM)</h1>
    <div id="chat-container">
      {% set messages = chat.message_set.all() %}
      <div id="messages-container" class="mx-1 pt-1">{% include 'fragments/messages.jinja' %}</div>
      <div class="add-message-container">
        <form hx-post="{{ request.path }}"
              hx-swap="beforeend"
              hx-target="#messages-container"
              id="chat-form">
          <div class="row mx-0">
            {{ form.message.label_tag(attrs={"class": "visually-hidden"}) }}
            <div class="col px-1">
              <div class="input-group">
                {{ form.message }}
                <button id="send-button" class="btn btn-outline-secondary" type="submit" aria-label="Send">
                  <i class="bi bi-send"></i>
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
  <script>
    /* Ctrl+Enter to submit */
    document.addEventListener('keydown', function (event) {
      if (event.ctrlKey && event.key === 'Enter') {
        document.getElementById('send-button').click();
      }
    });
    document.getElementById('id_message').focus();
  </script>
{% endblock content %}